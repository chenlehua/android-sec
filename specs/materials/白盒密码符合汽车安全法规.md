# **智能网联汽车采用白盒密码（WBC）作为TEE安全架构兼容备份方案的合规性深度研究报告**

## **摘要**

随着汽车电子电气架构（E/E架构）向集中化、智能化演进，车载硬件安全模块（HSM）与可信执行环境（TEE）已成为构建车辆网络安全信任根（Root
of
Trust）的行业基准。然而，在L3级以上自动驾驶对"失效-运行"（Fail-Operational）能力的严苛要求下，部分架构设计提议引入白盒密码（White-Box
Cryptography,
WBC）作为TEE硬件失效时的软件备份方案，以确保业务连续性。本报告针对这一架构主张，深入分析了其在《汽车整车信息安全技术要求》（GB
44495-2024）、联合国车辆网络安全法规（UN
R155）、以及《电动汽车远程服务与管理系统技术规范》（GB/T
32960）等关键法规下的合规性现状。

研究表明，尽管白盒密码在移动支付与数字版权管理领域应用广泛，但将其作为汽车核心安全架构的备份方案存在显著的合规风险。特别是GB/T
32960.2-2025修订版中关于T-BOX激活私钥必须存储于"具有硬件安全保护机制的车辆芯片"中的明确条款，直接否定了纯软件备份在关键环节的合法性。同时，GB
44495对密钥全生命周期管理中倾向于HSM硬件存储的要求，以及UN
R155对"现有技术水平"（State-of-the-Art）的界定，均使得WBC备份方案在型式认证（Type
Approval）中面临巨大的挑战。报告建议，为满足高等级自动驾驶的失效运行要求，应优先采用异构硬件冗余（如双HSM或安全岛机制），而非降级至软件密码方案，以避免触碰合规红线。

## **1. 引言：智能网联汽车安全架构的演进与挑战**

### **1.1 行业背景：从分布式到中央计算的信任重构**

智能网联汽车（ICV）正处于由传统的分布式ECU架构向域控制器（Domain
Controller）及中央计算平台（Central
Computing）转型的关键时期。这一转型不仅改变了车辆的控制逻辑，更重构了车辆的安全边界。在传统架构中，安全性往往依赖于物理隔离；而在现代软件定义汽车（SDV）架构中，基于密码学的逻辑隔离成为核心。TEE和HSM作为硬件层面的信任锚点，负责存储根密钥、执行加密运算及验证系统完整性，是当前防御网络攻击的基石
。

### **1.2 问题陈述："失效-运行"需求下的架构两难**

ISO 26262
功能安全标准要求L3级以上自动驾驶系统在发生单点故障时，必须具备"失效-运行"（Fail-Operational）能力，即系统不能直接停机，而应保持降级运行或维持一段时间的正常功能以进入最小风险状态（Minimal
Risk Condition, MRC）。 这给网络安全架构带来了挑战：

-   **主路径**：依赖HSM/TEE提供高等级安全保障。

-   **故障场景**：若HSM硬件模块发生物理损坏、死锁或通信中断，车辆控制指令的签名验证、V2X通信加密等关键功能将面临停摆。

-   **拟议方案**：引入白盒密码（WBC）作为软件备份。当检测到HSM失效时，系统切换至运行在主处理器（Rich
    > OS）上的WBC库，读取预置的（或动态分发的）混淆密钥继续执行密码运算。

### **1.3 报告目标与范围**

本报告旨在从法规合规性角度，详尽评估上述WBC备份方案的可行性。分析范围覆盖：

-   **核心法规**：中国强制性国家标准 GB 44495-2024、GB/T
    > 32960系列（含2025修订版）、联合国法规 UN R155。

-   **关联标准**：中国商用密码行业标准（GM/T系列）、ISO/SAE 21434
    > 网络安全工程标准。

-   **关键组件**：重点关注车载终端（T-BOX）、网关、车机系统（IVI）及自动驾驶域控制器。

## **2. 技术架构深度解析：TEE与白盒密码的本质差异**

在探讨合规性之前，必须明确TEE与WBC在技术实现与安全假设上的根本区别，这是理解法规适用性的前提。

### **2.1 可信执行环境（TEE）与硬件安全模块（HSM）**

TEE构建了一个硬件隔离的安全区域（Secure
World），与运行Android/Linux等富操作系统的普通区域（Normal
World）物理或逻辑隔离。

-   **信任根（RoT）**：TEE通常依赖SoC内部的硬件逻辑（如ARM
    > TrustZone）或独立的HSM芯片。密钥生成、存储和使用均在安全边界内完成，外部无法直接读取明文密钥。

-   **物理防御**：高等级的HSM（如EVITA
    > Full/Medium）具备防侧信道攻击（SCA）、防故障注入攻击（FI）和物理防篡改能力
    > 。

-   **法规地位**：在GB 44495和UN
    > R155的语境下，TEE/HSM被视为"基于硬件的安全保护"，是满足高安全等级（如GM/T
    > 0028 Level 2/3）的标准配置。

### **2.2 白盒密码（WBC）**

白盒密码旨在解决"白盒攻击环境"下的密钥保护问题，即假设攻击者拥有对执行环境的完全控制权（包括内存转储、指令级调试、代码修改）。

-   **技术原理**：WBC不通过物理边界隔离密钥，而是通过数学变换（如查找表网络、随机对偶同态）将密钥"溶解"在密码算法的代码逻辑中。内存中不存在静态的密钥比特，攻击者难以直接提取。

-   **安全局限**：

    -   **更新依赖**：WBC的安全性依赖于算法的复杂度和更新频率。一旦混淆逻辑被逆向（如通过差分计算分析DCA），系统即告破解
        > 。

    -   **代码剥离（Code
        > Lifting）**：攻击者无需提取密钥，只需将包含WBC功能的代码段完整复制（剥离），即可在其他设备上模拟合法的加密/签名功能。虽然可以通过节点锁定（Node
        > Locking）缓解，但在HSM失效的背景下，锁定的硬件锚点可能不复存在。

    -   **性能开销**：WBC的运算效率通常远低于硬件加速器，可能影响实时性要求高的车载通信（如CAN
        > FD/Ethernet验证）。

### **2.3 备份方案的架构悖论**

将WBC作为TEE的备份，本质上是在系统处于"非正常状态"（硬件故障）时，主动实施**安全降级**。

-   **触发机制风险**：攻击者无需攻破坚固的HSM，只需制造干扰（如DoS攻击、切断时钟/电源）诱骗系统判定HSM失效，从而强制系统切换至较脆弱的WBC模式，进而实施攻击。这种"降级攻击"窗口是ISO
    > 21434风险评估中的高危项 。

## **3. GB/T 32960 法规合规性详尽分析**

GB/T
32960《电动汽车远程服务与管理系统技术规范》是中国新能源汽车市场准入的核心标准。其第2部分（车载终端）对安全芯片的要求构成了WBC方案最难以逾越的合规障碍。

### **3.1 激活与身份认证的硬件强制性（2025版）**

根据最新的GB/T 32960.2-2025标准文本（参见研究片段 ），在"4.2.1
激活"条款中明确规定：

> **"车载终端首次使用时应进行激活。激活信息应使用存储在具有硬件安全保护机制的车辆芯片中的私钥进行数字签名，然后传输至服务端平台。"**

**深度解读：**

1.  **"具有硬件安全保护机制的车辆芯片"**：这一表述排他性地指向了SE（安全单元）或HSM。WBC运行在通用MCU/SoC的Flash/RAM中，属于软件实现，物理载体是通用计算芯片，不符合"硬件安全保护机制"的定义。

2.  **私钥存储位置**：条款强制要求私钥"存储在"该硬件芯片中。若采用WBC备份方案，意味着必须有另一份私钥（或同一私钥的副本）以混淆形式存在于软件代码或普通存储区中。这直接违反了"私钥存储于安全硬件"的排他性或主属性要求。

3.  **签名生成**：备份模式下，若HSM失效，T-BOX若改用WBC生成签名，则该签名并非由"存储在安全芯片中的私钥"生成，导致上传的数据包在法律意义上不符合GB
    > 32960格式要求。

### **3.2 实时数据传输的完整性与不可否认性**

GB
32960.2-2016及2025版均要求传输数据必须加密且"不可否认"（Undeniable）。

-   **不可否认性**依赖于非对称加密体系（PKI）和私钥的绝对控制。

-   如果系统允许退化到软件密码（WBC），且攻击者能够通过代码剥离（Code
    > Lifting）复制WBC模块，便能伪造车辆数据发送给国家监控平台。这将破坏数据的不可否认性，导致OEM在面临事故调查或补贴核算时面临法律风险。

-   **结论**：GB
    > 32960标准并未预留"硬件故障时的软件备份"条款。相反，标准要求终端在异常掉电下仍需独立运行并上传数据（依赖电池），但这强调的是电源鲁棒性，而非密码学鲁棒性。在密码模块失效时，合规的行为应当是上报故障（报警），而非切换至不合规的软件加密模式。

## **4. GB 44495-2024 与汽车信息安全强制标准分析**

GB
44495-2024《汽车整车信息安全技术要求》是中国即将全面实施的强制性国家标准，其对车辆网络安全的架构设计提出了具体约束。

### **4.1 密钥管理的硬件化趋势**

根据对GB 44495的综合解读（参见研究片段
），该标准在数据安全防护章节构建了全生命周期的防护框架，其中特别提到：

> **"要求对称密钥存储在HSM安全芯片内，而非对称密钥\..."**

**分析：**

这一要求比UN R155更为具体和严格。UN R155更多是基于风险的评估，而GB
44495直接引入了特定技术手段（HSM）的描述。

-   **WBC的冲突**：WBC的核心特性是将密钥隐藏在软件逻辑中。虽然在白盒攻击模型下它能提供一定的保护，但它在物理层面上并不满足"存储在HSM安全芯片内"的要求。

-   **备份合规性**：如果在主HSM失效后，系统切换到WBC，此时密钥实际上是加载到了通用内存（RAM）中进行运算（尽管是混淆态）。这种架构设计实际上是在特定工况下"绕过"了GB
    > 44495对密钥硬件存储的要求。除非OEM能向认证机构（如中汽中心CATARC）证明WBC在备份期间提供了与HSM**等同**的安全防护级别（这在技术上极难论证），否则将被视为违规。

### **4.2 零信任架构与微隔离**

GB 44495鼓励采用零信任模型，要求域间通信通过硬件防火墙进行微隔离 。

-   零信任的基础是强身份认证。如果作为身份凭证的密钥在备份模式下变成了软件形态（WBC），那么整个零信任链条的信任等级将由硬件级降级为软件级。

-   在GB
    > 44495的审核中，安全策略的一致性是审查重点。允许系统自动降级到低安全等级（Fail-Down）通常被视为设计缺陷，而非特性。

## **5. UN R155 与 ISO/SAE 21434 的国际视角**

虽然UN R155是法规，ISO/SAE
21434是支撑标准，二者共同构成了全球车辆网络安全准入的基础。

### **5.1 "现有技术水平"（State of the Art）的考量**

UN R155要求车辆制造商采取"与风险相称"的措施，并符合"现有技术水平"。

-   **行业现状**：当前汽车行业的"现有技术水平"对于高安全等级（CAL 3/CAL
    > 4）资产的保护，普遍采用的是HSM或TEE。

-   **WBC的定位**：WBC通常被视为在**缺乏硬件安全条件**（如老旧手机、低成本IoT设备）下的补救措施，或者是作为硬件安全的**补充**（深度防御），而非**替代**。

-   **备份方案的判定**：如果一个厂商声称其安全架构是State of the
    > Art，却设计了一个可以回退到软件密码的后门（备份路径），这在型式认证（Type
    > Approval）中极易受到挑战。技术服务机构（Technical
    > Service）会质疑：为什么不采用冗余的HSM（Dual
    > HSM）作为备份？后者才是航空航天和高等级自动驾驶中标准的失效运行方案
    > 。使用WBC备份可能被解读为为了节省成本而牺牲安全性，这不符合UN
    > R155的精神。

### **5.2 风险评估（TARA）中的漏洞**

ISO/SAE
21434要求对所有概念阶段的设计进行威胁分析与风险评估（TARA）。对于WBC备份方案，TARA分析必须包含以下攻击路径：

1.  **攻击者诱发HSM故障**：通过电压毛刺、温度干扰或总线泛洪，迫使系统判定HSM失效。

2.  **系统切换至WBC模式**：WBC代码及混淆密钥被激活加载到内存。

3.  **实施白盒攻击**：利用侧信道分析或代码剥离，从软件中提取权限或伪造签名。

由于WBC抵抗侧信道攻击的能力远弱于HSM，这条攻击路径的"可行性"（Feasibility）将显著高于直接攻击HSM。这将导致整体系统的剩余风险（Residual
Risk）升高，可能超出可接受范围（Risk Acceptance
Criteria），从而无法通过UN R155认证。

## **6. 商用密码（GM/T）体系下的合规性障碍**

在中国市场，除了GB标准，还必须遵循国家密码管理局（OSCCA）制定的GM/T行业标准。

### **6.1 密码模块安全等级认证（GM/T 0028）**

GM/T 0028《密码模块安全技术要求》将密码模块分为四个安全等级 。

-   **一级（Level 1）**：最低要求，通常对应纯软件实现。

-   **二级（Level
    > 2）**：要求具备物理安全机制（如防拆封签、基于角色的认证）。这是车载T-BOX、网关等关键设备通常要求的最低等级
    > 。

-   **三级（Level
    > 3）**：要求更强的物理防护和入侵检测（如EFP环境失效保护）。

**WBC的等级困境**：

白盒密码作为纯软件方案，即使算法再精妙，也难以满足GM/T
0028二级以上关于物理安全的硬性指标（如物理端口的保护、外壳防拆等）。

-   **结论**：如果车辆的安全认证要求T-BOX必须使用"二级密码模块"（这在涉及车控和隐私数据时是常态），那么WBC作为一级模块（或未定级模块），无法作为合法的备份组件。系统一旦切换到WBC，即意味着车辆的网络安全组件从"二级"降级为"一级"，这在合规审计中属于重大不符合项。

### **6.2 缺乏针对WBC的国家标准**

目前，中国商用密码体系中尚未发布专门针对白盒密码的检测标准和认证规范。虽然有些软件密码产品通过了认证，但主要是针对服务器端或特定应用环境
。在车规级高可靠、高安全要求的场景下，缺乏国密认证的WBC方案在法律上处于灰色地带，极易被监管部门认定为使用"未经许可或未通过检测的密码产品"。

## **7. "失效-运行"（Fail-Operational）的正确打开方式**

面对L3+自动驾驶对可用性的需求，如果WBC不是合规的答案，那么什么是？

### **7.1 功能安全与信息安全的协同**

ISO 26262（安全）关注可用性，ISO
21434（信息安全）关注保密性/完整性。在失效场景下，两者存在潜在冲突。

-   **安全优先**：为了防止车辆失控（可用性），系统必须继续运行。

-   **信息安全底线**：但在继续运行的过程中，不能允许恶意指令介入。

### **7.2 行业推荐方案：硬件冗余**

根据研究片段
及行业趋势，真正的Fail-Operational安全架构应基于**硬件冗余**。

-   **双SoC/双HSM架构**：在自动驾驶域控制器中，通常设计主控芯片（SoC
    > A）和冗余芯片（SoC B）。两者均内置独立的HSM/TEE。

-   **机制**：当SoC A的HSM失效时，控制权切换至SoC B，由SoC
    > B的HSM接管签名验证和加密任务。

-   **合规性优势**：

    1.  **GB
        > 32960**：备份路径依然使用"具有硬件安全保护机制的芯片"存储私钥，完全合规。

    2.  **GB 44495**：始终满足密钥存储于HSM的要求，无安全降级。

    3.  **UN R155**：这是公认的State of the
        > Art方案，风险评估中攻击难度未降低。

### **7.3 WBC的合理应用场景**

WBC并非毫无用处，它在非关键路径上仍有合规空间：

-   **信息娱乐系统（IVI）**：用于保护流媒体内容的DRM密钥 。

-   **手机端数字钥匙（Digital
    > Key）**：在用户的手机App中使用WBC保护车辆访问凭证（因为OEM无法控制用户手机是否有SE）。

-   **临时凭证**：V2X通信中极短有效期的假名证书，风险敞口较小。

但上述场景均不涉及核心的"TEE安全架构备份"命题。

## **8. 结论与建议**

### **8.1 综合结论**

将白盒密码（WBC）作为智能网联汽车TEE安全架构的兼容备份方案，**不符合**当前主流法规的严格要求，特别是在涉及车辆关键控制、T-BOX身份认证及隐私数据保护的场景下。

-   **对GB
    > 32960的违反**：WBC无法满足"激活私钥存储于硬件安全芯片"的强制条款，将导致T-BOX无法通过入网检测。

-   **对GB
    > 44495的违背**：WBC不符合密钥应存储于HSM的要求，构成了安全机制的降级。

-   **对UN
    > R155的挑战**：WBC备份方案引入了降级攻击风险，难以通过CSMS认证中的风险评估，且不代表行业"现有技术水平"。

-   **GM/T认证缺失**：WBC难以达到车载关键部件所需的密码模块安全等级（Level
    > 2+）。

### **8.2 致OEM与Tier-1供应商的建议**

1.  **避免在信任根中使用软件备份**：对于T-BOX、网关、智驾域控等核心节点，严禁设计"HSM失效后切换至WBC"的逻辑。

2.  **采用硬件冗余实现失效运行**：针对L3+自动驾驶的Fail-Operational需求，应采用双芯片、双HSM或Safety
    > Island架构，确保备份路径具备同等的硬件安全等级。

3.  **WBC仅用于深度防御**：可以将WBC作为应用层的额外防护（如防止App被逆向），但不能作为底层TEE的替代品或"备胎"。

4.  **关注法规迭代**：虽然目前法规倾向硬件，但随着后量子密码（PQC）和新型混淆技术的发展，未来软件密码的地位可能演变，需持续关注GB及GM/T标准的修订动态，但在当前时间点（2025-2026），硬件强制性是不可逾越的红线。

## **附录：法规条款对照表**

  -----------------------------------------------------------------------------------------------------------------------------------------
  **法规/标准**    **关键条款/要求**                                  **WBC备份方案状态**   **风险评级**
  ---------------- -------------------------------------------------- --------------------- -----------------------------------------------
  **GB/T           激活信息需使用**存储在硬件安全芯片中**的私钥签名   **不合规**            **极高** (无法入网销售)
  32960.2-2025**                                                                            

  **GB             对称密钥应存储于**HSM安全芯片**内                  **不合规**            **高** (型式认证失败)
  44495-2024**                                                                              

  **UN R155**      需证明安全措施符合**现有技术水平**且风险可控       **存疑/高风险**       **中/高** (需极强的TARA辩护)

  **GM/T 0028**    关键模块通常需达到**安全二级**以上 (物理防护)      **不达标**            **高** (国密合规性问题)

  **ISO 26262**    要求**失效-运行** (Fail-Operational)               **兼容**              **低**
                                                                                            (从功能安全角度WBC可行，但受限于信息安全法规)
  -----------------------------------------------------------------------------------------------------------------------------------------

*(本报告基于截止2026年初的法规状态与技术实践进行分析，具体项目实施需结合当地监管机构的最新解释)*
